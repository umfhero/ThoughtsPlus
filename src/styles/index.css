/* Import local fonts for APPX/Store compatibility */
@import '../assets/fonts/fonts.css';

@tailwind base;
@tailwind components;
@tailwind utilities;

/* PDF Viewer Theming */
.pdf-light .react-pdf__Page__canvas {
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.pdf-dark .react-pdf__Page__canvas {
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
  filter: brightness(0.9);
}

.pdf-dark .react-pdf__Page__textContent {
  color: #e5e7eb;
}

.pdf-dark .react-pdf__Page__annotations {
  filter: invert(0.9);
}

/* Excel (XLSX) Preview Styling */
.xlsx-preview {
  padding: 1rem;
}

.sheet-container {
  margin-bottom: 2rem;
}

.sheet-title {
  font-size: 1.25rem;
  font-weight: bold;
  margin-bottom: 1rem;
  padding-bottom: 0.5rem;
  border-bottom: 2px solid #e5e7eb;
}

.sheet-divider {
  margin: 2rem 0;
  border: none;
  border-top: 2px solid #e5e7eb;
}

.xlsx-preview table {
  border-collapse: collapse;
  width: 100%;
  margin: 1rem 0;
  font-size: 0.875rem;
}

.xlsx-preview td,
.xlsx-preview th {
  border: 1px solid #d1d5db;
  padding: 0.5rem;
  text-align: left;
}

.xlsx-preview th {
  background-color: #f3f4f6;
  font-weight: 600;
}

/* Dark mode for XLSX */
.dark-mode .sheet-title {
  color: #f3f4f6;
  border-bottom-color: #4b5563;
}

.dark-mode .sheet-divider {
  border-top-color: #4b5563;
}

.dark-mode .xlsx-preview td,
.dark-mode .xlsx-preview th {
  border-color: #4b5563;
  background-color: #1f2937;
  color: #e5e7eb;
}

.dark-mode .xlsx-preview th {
  background-color: #374151;
  color: #f3f4f6;
}

/* PowerPoint (PPTX) Preview Styling */
.pptx-preview {
  padding: 1rem;
}

.pptx-preview-container {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
  padding: 1rem;
}

/* Full slide image rendering */
.slide-image-card {
  border: 2px solid #e5e7eb;
  border-radius: 0.75rem;
  overflow: hidden;
  background-color: #ffffff;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  transition: transform 0.2s, box-shadow 0.2s;
}

.slide-image-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.slide-image-card.dark {
  background-color: #1f2937;
  border-color: #4b5563;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

.slide-image-card.dark:hover {
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
}

.slide-image-container {
  width: 100%;
  background-color: #000000;
  display: flex;
  justify-content: center;
  align-items: center;
}

.full-slide-image {
  width: 100%;
  height: auto;
  display: block;
}

/* Enhanced slide rendering with backgrounds */
.slide-card-enhanced {
  border: 2px solid #e5e7eb;
  border-radius: 0.75rem;
  overflow: hidden;
  background-color: #ffffff;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  transition: transform 0.2s, box-shadow 0.2s;
}

.slide-card-enhanced:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.slide-card-enhanced.dark {
  background-color: #1f2937;
  border-color: #4b5563;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

.slide-card-enhanced.dark:hover {
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
}

.slide-body-enhanced {
  position: relative;
  min-height: 400px;
  padding: 2rem;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  background-color: #f9fafb;
}

.slide-images-overlay {
  position: relative;
  width: 100%;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1rem;
  margin-bottom: 1.5rem;
  z-index: 2;
}

.slide-image-overlay {
  width: 100%;
  height: auto;
  max-height: 500px;
  object-fit: contain;
  border-radius: 0.5rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.slide-text-overlay {
  position: relative;
  font-size: 1.125rem;
  line-height: 1.8;
  color: #1f2937;
  white-space: pre-wrap;
  word-wrap: break-word;
  text-align: center;
  max-width: 90%;
  padding: 1.5rem;
  background-color: rgba(255, 255, 255, 0.9);
  border-radius: 0.5rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  z-index: 2;
}

.slide-card-enhanced.dark .slide-body-enhanced {
  background-color: #111827;
}

.slide-card-enhanced.dark .slide-text-overlay {
  color: #f3f4f6;
  background-color: rgba(31, 41, 55, 0.9);
}

/* Basic text + images rendering */
.slide-card {
  border: 2px solid #e5e7eb;
  border-radius: 0.75rem;
  overflow: hidden;
  background-color: #ffffff;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  transition: transform 0.2s, box-shadow 0.2s;
}

.slide-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.slide-card.dark {
  background-color: #1f2937;
  border-color: #4b5563;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

.slide-card.dark:hover {
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
}

.slide-header {
  padding: 0.75rem 1rem;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.slide-number-badge {
  font-size: 0.875rem;
  font-weight: 600;
  color: #ffffff;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.slide-body {
  padding: 1.5rem;
}

.slide-images {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
  margin-bottom: 1rem;
}

.slide-image {
  width: 100%;
  height: auto;
  max-height: 400px;
  object-fit: contain;
  border-radius: 0.5rem;
  background-color: #f9fafb;
  padding: 0.5rem;
}

.slide-card.dark .slide-image {
  background-color: #111827;
}

.slide-text {
  font-size: 1rem;
  line-height: 1.6;
  color: #1f2937;
  white-space: pre-wrap;
  word-wrap: break-word;
}

.slide-card.dark .slide-text {
  color: #e5e7eb;
}

/* Legacy PPTX styles (for backward compatibility) */
.slide-container {
  margin-bottom: 2rem;
  padding: 1.5rem;
  border: 2px solid #e5e7eb;
  border-radius: 0.5rem;
  background-color: #ffffff;
}

.slide-number {
  font-size: 0.875rem;
  font-weight: 600;
  color: #6b7280;
  margin-bottom: 1rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.slide-content {
  font-size: 1rem;
  line-height: 1.6;
  color: #1f2937;
  white-space: pre-wrap;
}

/* Dark mode for PPTX */
.dark-mode .slide-container {
  background-color: #1f2937;
  border-color: #4b5563;
}

.dark-mode .slide-number {
  color: #9ca3af;
}

.dark-mode .slide-content {
  color: #e5e7eb;
}

/* Prose styling for DOCX preview */
.prose {
  max-width: 65ch;
  line-height: 1.6;
}

.prose p {
  margin-bottom: 1em;
}

.prose h1 {
  font-size: 2em;
  font-weight: bold;
  margin-top: 0.67em;
  margin-bottom: 0.67em;
}

.prose h2 {
  font-size: 1.5em;
  font-weight: bold;
  margin-top: 0.83em;
  margin-bottom: 0.83em;
}

.prose h3 {
  font-size: 1.17em;
  font-weight: bold;
  margin-top: 1em;
  margin-bottom: 1em;
}

.prose strong {
  font-weight: bold;
}

.prose em {
  font-style: italic;
}

.prose table {
  border-collapse: collapse;
  width: 100%;
  margin: 1em 0;
}

.prose td,
.prose th {
  border: 1px solid #ddd;
  padding: 8px;
  text-align: left;
}

.prose th {
  background-color: #f2f2f2;
  font-weight: bold;
}

.prose img {
  max-width: 100%;
  height: auto;
  margin: 1em 0;
}

.prose ul,
.prose ol {
  margin: 1em 0;
  padding-left: 2em;
}

.prose li {
  margin: 0.5em 0;
}

/* Dark mode overrides for DOCX */
.prose-invert {
  color: #e5e7eb;
}

.prose-invert h1,
.prose-invert h2,
.prose-invert h3,
.prose-invert h4,
.prose-invert h5,
.prose-invert h6 {
  color: #f3f4f6;
}

.prose-invert a {
  color: #60a5fa;
}

.prose-invert strong {
  color: #f3f4f6;
  font-weight: bold;
}

.prose-invert em {
  color: #e5e7eb;
  font-style: italic;
}

.prose-invert code {
  color: #f3f4f6;
  background-color: #374151;
}

.prose-invert pre {
  background-color: #1f2937;
  color: #e5e7eb;
}

.prose-invert table {
  border-color: #4b5563;
}

.prose-invert td,
.prose-invert th {
  border-color: #4b5563;
}

.prose-invert th {
  background-color: #374151;
  color: #f3f4f6;
}

.prose-invert td {
  background-color: #1f2937;
}


html,
body,
#root {
  overflow: hidden;
  height: 100%;
  width: 100%;
}

body {
  @apply bg-gray-50 text-gray-900 font-sans;
  /* Use CSS variable system - falls back to system fonts if local fonts unavailable */
  font-family: var(--app-font, 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Helvetica Neue', sans-serif);
}

@keyframes shake {
  0% {
    transform: rotate(0deg);
  }

  25% {
    transform: rotate(0.5deg);
  }

  75% {
    transform: rotate(-0.5deg);
  }

  100% {
    transform: rotate(0deg);
  }
}

.shake-animation {
  animation: shake 0.3s infinite ease-in-out;
}

/* Custom Scrollbar - Auto Hides */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  /* Default: Transparent Gray-300 */
  background-color: rgba(209, 213, 219, 0);
  border-radius: 9999px;
  transition: background-color 0.8s ease-in-out;
}

/* Show on scroll */
body.is-scrolling ::-webkit-scrollbar-thumb {
  background-color: rgba(209, 213, 219, 1);
  /* Gray-300 */
}

/* Show on hover */
::-webkit-scrollbar-thumb:hover {
  background-color: rgba(156, 163, 175, 1);
  /* Gray-400 */
}

/* Dark mode scrollbar */
.dark ::-webkit-scrollbar-thumb {
  /* Default: Transparent Gray-600 */
  background-color: rgba(75, 85, 99, 0);
}

.dark body.is-scrolling ::-webkit-scrollbar-thumb {
  background-color: rgba(75, 85, 99, 1);
  /* Gray-600 */
}

.dark ::-webkit-scrollbar-thumb:hover {
  background-color: rgba(107, 114, 128, 1);
  /* Gray-500 */
}

/* Thin scrollbar for specific containers */
.thin-scrollbar::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}

.thin-scrollbar::-webkit-scrollbar-track {
  @apply bg-gray-100 dark:bg-gray-700/50 rounded-full;
  margin: 4px;
}

.thin-scrollbar::-webkit-scrollbar-thumb {
  @apply bg-gray-300 dark:bg-gray-600 rounded-full;
  border: 2px solid transparent;
  background-clip: padding-box;
}

.thin-scrollbar::-webkit-scrollbar-thumb:hover {
  @apply bg-gray-400 dark:bg-gray-500;
}

/* Hide ActivityCalendar internal footer (contribution count and legend) */
.react-activity-calendar__footer {
  display: none !important;
}

/* Accent color system - CSS variables set by ThemeContext */
:root {
  --accent-primary: rgb(59, 130, 246);
  --accent-secondary: rgb(37, 99, 235);
  --accent-light: rgb(219, 234, 254);
}

/* Custom theme class - applies custom colors via CSS variables */
.custom {
  /* Background colors */
  --tw-bg-opacity: 1;
  background-color: var(--custom-bg, #ffffff);
  color: var(--custom-text, #111827);
}

/* Custom theme overrides for common Tailwind classes */
.custom .bg-white,
.custom .bg-gray-50 {
  background-color: var(--custom-bg, #ffffff) !important;
}

.custom .bg-gray-100 {
  background-color: color-mix(in srgb, var(--custom-bg, #ffffff) 95%, var(--custom-text, #111827) 5%) !important;
}

.custom .dark\:bg-gray-800,
.custom .dark\:bg-gray-900 {
  background-color: var(--custom-bg, #111827) !important;
}

.custom .text-gray-900,
.custom .text-gray-800,
.custom .text-gray-700 {
  color: var(--custom-text, #111827) !important;
}

.custom .dark\:text-gray-100,
.custom .dark\:text-gray-200,
.custom .dark\:text-white {
  color: var(--custom-text, #f3f4f6) !important;
}

.custom .border-gray-200,
.custom .border-gray-300 {
  border-color: var(--custom-border, #e5e7eb) !important;
}

.custom .dark\:border-gray-700,
.custom .dark\:border-gray-600 {
  border-color: var(--custom-border, #374151) !important;
}

/* Custom theme sidebar background overrides */
.custom aside,
.custom [class*="sidebar"],
.custom .bg-white\/80,
.custom .dark\:bg-gray-800\/80 {
  background-color: var(--custom-sidebar, #f9fafb) !important;
}

/* Custom theme card/panel background overrides */
.custom .rounded-3xl.bg-white,
.custom .rounded-2xl.bg-white,
.custom .rounded-xl.bg-white,
.custom .rounded-lg.bg-white,
.custom .bg-white.rounded-3xl,
.custom .bg-white.rounded-2xl,
.custom .bg-white.rounded-xl,
.custom .bg-white.rounded-lg {
  background-color: var(--custom-card, #ffffff) !important;
}

.custom .dark\:bg-gray-800.rounded-3xl,
.custom .dark\:bg-gray-800.rounded-2xl,
.custom .dark\:bg-gray-800.rounded-xl,
.custom .dark\:bg-gray-800.rounded-lg,
.custom .rounded-3xl.dark\:bg-gray-800,
.custom .rounded-2xl.dark\:bg-gray-800,
.custom .rounded-xl.dark\:bg-gray-800,
.custom .rounded-lg.dark\:bg-gray-800 {
  background-color: var(--custom-card, #1f2937) !important;
}

/* Sidebar specific - handle backdrop-blur containers */
.custom .backdrop-blur-xl {
  background-color: var(--custom-sidebar, #f9fafb) !important;
}

/* Custom scrollbar for board notes - hidden by default, shows on hover */
.custom-scrollbar {
  scrollbar-width: thin;
  scrollbar-color: transparent transparent;
}

.custom-scrollbar::-webkit-scrollbar {
  width: 4px;
  height: 4px;
}

.custom-scrollbar::-webkit-scrollbar-track {
  background: transparent;
}

.custom-scrollbar::-webkit-scrollbar-thumb {
  background: transparent;
  border-radius: 10px;
}

.custom-scrollbar:hover {
  scrollbar-color: rgba(156, 163, 175, 0.5) transparent;
}

.custom-scrollbar:hover::-webkit-scrollbar-thumb {
  background: rgba(156, 163, 175, 0.5);
}

.custom-scrollbar:hover::-webkit-scrollbar-thumb:hover {
  background: rgba(107, 114, 128, 0.7);
}

.dark .custom-scrollbar:hover {
  scrollbar-color: rgba(75, 85, 99, 0.5) transparent;
}

.dark .custom-scrollbar:hover::-webkit-scrollbar-thumb {
  background: rgba(75, 85, 99, 0.5);
}

.dark .custom-scrollbar:hover::-webkit-scrollbar-thumb:hover {
  background: rgba(107, 114, 128, 0.7);
}

/* ContentEditable placeholder */
[contenteditable][data-placeholder]:empty:before {
  content: attr(data-placeholder);
  color: rgba(156, 163, 175, 0.7);
  pointer-events: none;
}

/* ============================================
   Text Overflow Prevention for Settings Page
   Ensures text doesn't overflow containers when
   displaying translated strings in different languages
   ============================================ */

/* Settings section labels - prevent overflow with ellipsis */
.settings-label {
  @apply overflow-hidden text-ellipsis whitespace-nowrap;
  max-width: 100%;
}

/* Settings section labels that can wrap */
.settings-label-wrap {
  @apply overflow-hidden;
  word-wrap: break-word;
  overflow-wrap: break-word;
  hyphens: auto;
}

/* Settings description text - allow wrapping but prevent overflow */
.settings-description {
  @apply overflow-hidden;
  word-wrap: break-word;
  overflow-wrap: break-word;
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
}

/* Settings card container - ensure content doesn't overflow */
.settings-card {
  @apply overflow-hidden;
  min-width: 0;
}

/* Settings input labels - truncate with ellipsis */
.settings-input-label {
  @apply overflow-hidden text-ellipsis whitespace-nowrap block;
  max-width: 100%;
}

/* Settings button text - prevent overflow */
.settings-button-text {
  @apply overflow-hidden text-ellipsis whitespace-nowrap;
  max-width: 100%;
}

/* Settings toggle label - truncate long text */
.settings-toggle-label {
  @apply overflow-hidden text-ellipsis;
  max-width: calc(100% - 60px);
  /* Account for toggle switch width */
}

/* Settings section title - prevent overflow */
.settings-section-title {
  @apply overflow-hidden text-ellipsis whitespace-nowrap;
  max-width: 100%;
}

/* Flex container with text that should truncate */
.settings-flex-truncate {
  @apply flex items-center gap-2 min-w-0;
}

.settings-flex-truncate>span,
.settings-flex-truncate>p {
  @apply overflow-hidden text-ellipsis whitespace-nowrap;
  min-width: 0;
}

/* Grid items in settings - ensure proper text handling */
.settings-grid-item {
  @apply overflow-hidden min-w-0;
}

.settings-grid-item>* {
  @apply overflow-hidden text-ellipsis;
}

/* Language selector specific - handle long native language names */
.language-option-text {
  @apply overflow-hidden text-ellipsis whitespace-nowrap;
  min-width: 0;
  flex: 1;
}

/* Theme name in saved themes list */
.theme-name-text {
  @apply overflow-hidden text-ellipsis whitespace-nowrap;
  max-width: 150px;
}

/* Color picker label text */
.color-picker-label {
  @apply overflow-hidden text-ellipsis whitespace-nowrap block;
  max-width: 100%;
}

/* Provider button text in AI configuration */
.provider-button-text {
  @apply overflow-hidden text-ellipsis whitespace-nowrap;
  max-width: 100%;
}


/* ============================================
   Prism.js Light Theme Override for Nerdbook
   Applied when code cells use light theme
   ============================================ */

/* Light theme syntax highlighting - override prism-tomorrow dark theme */
.prism-light,
.prism-light code,
.prism-light pre {
  color: #24292e !important;
  background: transparent !important;
}

.prism-light .token.comment,
.prism-light .token.prolog,
.prism-light .token.doctype,
.prism-light .token.cdata {
  color: #6a737d !important;
}

.prism-light .token.punctuation {
  color: #24292e !important;
}

.prism-light .token.namespace {
  opacity: 0.7;
}

.prism-light .token.property,
.prism-light .token.tag,
.prism-light .token.boolean,
.prism-light .token.number,
.prism-light .token.constant,
.prism-light .token.symbol,
.prism-light .token.deleted {
  color: #005cc5 !important;
}

.prism-light .token.selector,
.prism-light .token.attr-name,
.prism-light .token.string,
.prism-light .token.char,
.prism-light .token.builtin,
.prism-light .token.inserted {
  color: #22863a !important;
}

.prism-light .token.operator,
.prism-light .token.entity,
.prism-light .token.url,
.prism-light .language-css .token.string,
.prism-light .style .token.string {
  color: #d73a49 !important;
}

.prism-light .token.atrule,
.prism-light .token.attr-value,
.prism-light .token.keyword {
  color: #d73a49 !important;
}

.prism-light .token.function,
.prism-light .token.class-name {
  color: #6f42c1 !important;
}

.prism-light .token.regex,
.prism-light .token.important,
.prism-light .token.variable {
  color: #e36209 !important;
}

.prism-light .token.important,
.prism-light .token.bold {
  font-weight: bold;
}

.prism-light .token.italic {
  font-style: italic;
}

.prism-light .token.entity {
  cursor: help;
}


/* Hide scrollbar on workspace tab bar */
.workspace-tabbar-scroll::-webkit-scrollbar {
  display: none !important;
  width: 0 !important;
  height: 0 !important;
}

/* ============================================
   Flat Mode - Minimal container styling
   Only removes outermost container backgrounds/borders
   Adds thin divider lines between major sections
   Does NOT affect inner elements, colors, toggles, etc.
   EXCLUDED from Workspace page (has data-page="workspace")
   ============================================ */

/* Sidebar vertical divider - visible line between sidebar and main content */
.flat-mode:not([data-page="workspace"]) .sidebar-wrapper {
  position: relative;
  overflow: visible !important;
  /* Allow toggle button to remain visible when sidebar collapsed */
}

.flat-mode:not([data-page="workspace"]) .sidebar-wrapper::after {
  content: '';
  position: absolute;
  top: 0;
  right: 0;
  width: 1px;
  height: 100%;
  background-color: rgba(156, 163, 175, 0.5);
  z-index: 100;
}

.flat-mode.dark:not([data-page="workspace"]) .sidebar-wrapper::after {
  background-color: rgba(107, 114, 128, 0.5);
}

/* Make the sidebar container background invisible */
.flat-mode:not([data-page="workspace"]) .sidebar-wrapper [class*="rounded-3xl"],
.flat-mode:not([data-page="workspace"]) .sidebar-wrapper [class*="bg-white"],
.flat-mode:not([data-page="workspace"]) .sidebar-wrapper [class*="backdrop-blur"] {
  background-color: transparent !important;
  border-color: transparent !important;
  box-shadow: none !important;
}

.flat-mode.dark:not([data-page="workspace"]) .sidebar-wrapper [class*="rounded-3xl"],
.flat-mode.dark:not([data-page="workspace"]) .sidebar-wrapper [class*="bg-gray-8"] {
  background-color: transparent !important;
  border-color: transparent !important;
  box-shadow: none !important;
}

/* Only remove shadows on the outermost page container level */
.flat-mode:not([data-page="workspace"]) [class*="shadow-xl"],
.flat-mode:not([data-page="workspace"]) [class*="shadow-lg"],
.flat-mode:not([data-page="workspace"]) [class*="shadow-2xl"] {
  box-shadow: none !important;
}

/* Target main section containers - make background transparent but keep content intact */
/* These are the cards with rounded-3xl bg-white in Settings and other pages */
.flat-mode:not([data-page="workspace"]) .flat-container,
.flat-mode:not([data-page="workspace"]) [class*="rounded-3xl"][class*="bg-white"],
.flat-mode:not([data-page="workspace"]) [class*="rounded-3xl"][class*="bg-gray-800"] {
  background-color: transparent !important;
  border-color: transparent !important;
  box-shadow: none !important;
  overflow: visible !important;
  /* Allow pseudo-element lines to show */
}

/* Dashboard + Progress: flatten rounded-2xl and rounded-[2rem] cards */
.flat-mode[data-page="dashboard"] [class*="rounded-2xl"][class*="bg-white"],
.flat-mode[data-page="dashboard"] [class*="rounded-[2rem]"][class*="bg-white"],
.flat-mode[data-page="progress"] [class*="rounded-2xl"][class*="bg-white"],
.flat-mode[data-page="progress"] [class*="rounded-[2rem]"][class*="bg-white"] {
  background-color: transparent !important;
  border-color: transparent !important;
  box-shadow: none !important;
  overflow: visible !important;
}

.flat-mode.dark[data-page="dashboard"] [class*="rounded-2xl"][class*="bg-gray-800"],
.flat-mode.dark[data-page="dashboard"] [class*="rounded-[2rem]"][class*="bg-gray-800"],
.flat-mode.dark[data-page="progress"] [class*="rounded-2xl"][class*="bg-gray-800"],
.flat-mode.dark[data-page="progress"] [class*="rounded-[2rem]"][class*="bg-gray-800"] {
  background-color: transparent !important;
  border-color: transparent !important;
  box-shadow: none !important;
  overflow: visible !important;
}

/* Calendar (light touch): flatten toolbar chrome only */
.flat-mode[data-page="calendar"] [data-flat-toolbar] {
  background-color: transparent !important;
  border-color: transparent !important;
  box-shadow: none !important;
  backdrop-filter: none !important;
}

/* ====== HORIZONTAL LINES BETWEEN SECTIONS ====== */
/* Every major section child in the settings/main area should have a separating bottom line */
.flat-mode:not([data-page="workspace"])>div>main>div>div>section,
.flat-mode:not([data-page="workspace"])>div>main>div>div>div,
.flat-mode:not([data-page="workspace"])>div>main>div>div>.grid,
.flat-mode:not([data-page="workspace"])>div>main>div>div>[class*="rounded-3xl"] {
  position: relative;
  overflow: visible !important;
}

/* Horizontal separators for main section blocks */
.flat-mode:not([data-page="workspace"])>div>main>div>div>[class*="rounded-3xl"]::after,
.flat-mode:not([data-page="workspace"])>div>main>div>div>.grid::after {
  content: '';
  position: absolute;
  bottom: -0.75rem;
  left: 0;
  width: 100%;
  height: 1px;
  background: linear-gradient(to right,
      transparent 0%,
      rgba(156, 163, 175, 0.45) 5%,
      rgba(156, 163, 175, 0.45) 95%,
      transparent 100%);
  z-index: 10;
}

.flat-mode.dark:not([data-page="workspace"])>div>main>div>div>[class*="rounded-3xl"]::after,
.flat-mode.dark:not([data-page="workspace"])>div>main>div>div>.grid::after {
  background: linear-gradient(to right,
      transparent 0%,
      rgba(107, 114, 128, 0.45) 5%,
      rgba(107, 114, 128, 0.45) 95%,
      transparent 100%);
}

/* Specific fix for ThoughtsPlus container (first section) */
.flat-mode:not([data-page="workspace"]) .mb-8+[class*="rounded-3xl"]::after {
  display: block !important;
}

/* Don't show the line on the very last section child */
.flat-mode:not([data-page="workspace"])>div>main>div>div>*:last-child::after {
  display: none !important;
}

/* Manual section lines for specific containers */
.flat-mode:not([data-page="workspace"]) [data-flat-top],
.flat-mode:not([data-page="workspace"]) [data-flat-bottom] {
  position: relative;
  overflow: visible !important;
  --flat-divider-gap: var(--flat-divider-gap, 1.5rem);
}

.flat-mode:not([data-page="workspace"]) [data-flat-top]:not([data-flat-in-grid])::before {
  content: '';
  position: absolute;
  left: 0 !important;
  right: 0 !important;
  width: auto !important;
  height: 1px !important;
  top: -0.75rem !important;
  background: linear-gradient(to right,
      transparent 0%,
      rgba(156, 163, 175, 0.45) 5%,
      rgba(156, 163, 175, 0.45) 95%,
      transparent 100%) !important;
  z-index: 10;
  pointer-events: none;
  display: block !important;
}

.flat-mode:not([data-page="workspace"]) [data-flat-bottom]::after {
  content: '';
  position: absolute;
  left: 0 !important;
  right: 0 !important;
  width: auto !important;
  height: 1px !important;
  background: linear-gradient(to right,
      transparent 0%,
      rgba(156, 163, 175, 0.45) 5%,
      rgba(156, 163, 175, 0.45) 95%,
      transparent 100%) !important;
  z-index: 10;
  pointer-events: none;
  display: block !important;
}

.flat-mode:not([data-page="workspace"]) [data-flat-bottom]::after {
  bottom: -0.75rem !important;
}

.flat-mode.dark:not([data-page="workspace"]) [data-flat-bottom]::after {
  background: linear-gradient(to right,
      transparent 0%,
      rgba(107, 114, 128, 0.45) 5%,
      rgba(107, 114, 128, 0.45) 95%,
      transparent 100%) !important;
}

.flat-mode.dark:not([data-page="workspace"]) [data-flat-top]:not([data-flat-in-grid])::before {
  background: linear-gradient(to right,
      transparent 0%,
      rgba(107, 114, 128, 0.45) 5%,
      rgba(107, 114, 128, 0.45) 95%,
      transparent 100%) !important;
}

/* Full-width row dividers for top markers */
.flat-mode:not([data-page="workspace"]) [data-flat-row-divider] {
  position: absolute;
  left: 0;
  right: 0;
  height: 1px;
  background: linear-gradient(to right,
      transparent 0%,
      rgba(156, 163, 175, 0.45) 5%,
      rgba(156, 163, 175, 0.45) 95%,
      transparent 100%);
  z-index: 10;
  pointer-events: none;
}

.flat-mode.dark:not([data-page="workspace"]) [data-flat-row-divider] {
  background: linear-gradient(to right,
      transparent 0%,
      rgba(107, 114, 128, 0.45) 5%,
      rgba(107, 114, 128, 0.45) 95%,
      transparent 100%);
}

/* ====== GRID INTERNAL LINES ====== */
/* Opt-in grids for precise separators (e.g., Settings main grid) */
.flat-mode:not([data-page="workspace"]) [data-flat-grid] {
  --flat-divider-col-gap: 1.5rem;
  --flat-divider-row-gap: 1.5rem;
  position: relative;
}

.flat-mode:not([data-page="workspace"]) [data-flat-grid]:not([data-flat-scroll]) {
  overflow: visible !important;
}

/* Cards inside opt-in grids need positioning and visible overflow for pseudo-elements */
.flat-mode:not([data-page="workspace"]) [data-flat-grid]>[data-flat-in-grid] {
  position: relative;
  overflow: visible !important;
}

/* VERTICAL LINES: 70% height, centered, top/bottom fade */
.flat-mode:not([data-page="workspace"]) [data-flat-grid]>[data-flat-in-grid]::before {
  content: '';
  position: absolute;
  top: 15%;
  right: calc(var(--flat-divider-col-gap) * -0.5);
  width: 1px;
  height: 70%;
  background: linear-gradient(to bottom,
      transparent 0%,
      rgba(156, 163, 175, 0.4) 10%,
      rgba(156, 163, 175, 0.4) 90%,
      transparent 100%);
  z-index: 10;
  display: none;
}

.flat-mode.dark:not([data-page="workspace"]) [data-flat-grid]>[data-flat-in-grid]::before {
  background: linear-gradient(to bottom,
      transparent 0%,
      rgba(107, 114, 128, 0.4) 10%,
      rgba(107, 114, 128, 0.4) 90%,
      transparent 100%);
}

/* Show vertical lines only between actual neighbors */
.flat-mode:not([data-page="workspace"]) [data-flat-grid]>[data-flat-right]::before {
  display: block;
}

/* HORIZONTAL LINES: only under full-width (long) items inside the grid */
.flat-mode:not([data-page="workspace"]) [data-flat-grid]>[data-flat-long] {
  position: relative;
  overflow: visible !important;
}

.flat-mode:not([data-page="workspace"]) [data-flat-grid]>[data-flat-long]::after {
  content: '';
  position: absolute;
  bottom: calc(var(--flat-divider-row-gap) * -0.5);
  left: 0;
  width: 100%;
  height: 1px;
  background: linear-gradient(to right,
      transparent 0%,
      rgba(156, 163, 175, 0.45) 5%,
      rgba(156, 163, 175, 0.45) 95%,
      transparent 100%);
  z-index: 10;
}

.flat-mode.dark:not([data-page="workspace"]) [data-flat-grid]>[data-flat-long]::after {
  background: linear-gradient(to right,
      transparent 0%,
      rgba(107, 114, 128, 0.45) 5%,
      rgba(107, 114, 128, 0.45) 95%,
      transparent 100%);
}


/* ============================================
   Sharp Corners Mode - 90 degree angles
   Removes all border-radius
   EXCLUDED from Workspace page (has data-page="workspace")
   ============================================ */

.sharp-corners:not([data-page="workspace"]) *,
.sharp-corners:not([data-page="workspace"]) *::before,
.sharp-corners:not([data-page="workspace"]) *::after {
  border-radius: 0 !important;
}

/* Apply to common rounded classes - use attribute selectors */
.sharp-corners:not([data-page="workspace"]) [class*="rounded"] {
  border-radius: 0 !important;
}

/* Scrollbar in sharp corners mode */
.sharp-corners:not([data-page="workspace"]) ::-webkit-scrollbar-thumb {
  border-radius: 0 !important;
}

.sharp-corners:not([data-page="workspace"]) ::-webkit-scrollbar-track {
  border-radius: 0 !important;
}

/* Buttons and inputs */
.sharp-corners:not([data-page="workspace"]) button,
.sharp-corners:not([data-page="workspace"]) input,
.sharp-corners:not([data-page="workspace"]) select,
.sharp-corners:not([data-page="workspace"]) textarea {
  border-radius: 0 !important;
}

/* Pills and badges */
.sharp-corners:not([data-page="workspace"]) .pill,
.sharp-corners:not([data-page="workspace"]) .badge,
.sharp-corners:not([data-page="workspace"]) .tag,
.sharp-corners:not([data-page="workspace"]) .chip {
  border-radius: 0 !important;
}

/* Toggle switches - keep slightly rounded for usability */
.sharp-corners:not([data-page="workspace"]) .toggle-switch,
.sharp-corners:not([data-page="workspace"]) [role="switch"] {
  border-radius: 2px !important;
}

.sharp-corners:not([data-page="workspace"]) .toggle-switch>*,
.sharp-corners:not([data-page="workspace"]) [role="switch"]>* {
  border-radius: 1px !important;
}

/* Images can stay slightly rounded if needed */
.sharp-corners:not([data-page="workspace"]) img.avatar,
.sharp-corners:not([data-page="workspace"]) .avatar {
  border-radius: 0 !important;
}

/* Dropdowns and menus */
.sharp-corners:not([data-page="workspace"]) [role="menu"],
.sharp-corners:not([data-page="workspace"]) [role="listbox"],
.sharp-corners:not([data-page="workspace"]) .dropdown,
.sharp-corners:not([data-page="workspace"]) .menu {
  border-radius: 0 !important;
}

/* Tooltip corners */
.sharp-corners:not([data-page="workspace"]) [role="tooltip"],
.sharp-corners:not([data-page="workspace"]) .tooltip {
  border-radius: 0 !important;
}

/* Progress bars */
.sharp-corners:not([data-page="workspace"]) .progress,
.sharp-corners:not([data-page="workspace"]) [role="progressbar"] {
  border-radius: 0 !important;
}

.sharp-corners:not([data-page="workspace"]) .progress>*,
.sharp-corners:not([data-page="workspace"]) [role="progressbar"]>* {
  border-radius: 0 !important;
}
